<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="CleverStack, the Enterprise-grade, Open-Source Full-Stack JavaScript Framework built on NodeJS and Angular, MEAN and so much more!">
<meta name="keywords" content="HTML, CSS, JS, JavaScript, framework, bootstrap, front-end, frontend, web development, node.js, express, mongoose, mongodb, angularjs, swig, sequelize, sequelizejs, orm, odm, cli">
<meta name="author" content="Richard Gustin and contributors to the CleverStack Repositories">

<title>
  
    Backend Documenation &middot; CleverStack.io
  
</title>

<!-- Bootstrap core CSS -->
<link href="/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Theme CSS -->
<link href="/dist/css/bootstrap-theme.min.css" rel="stylesheet">

<!-- Application CSS -->
<link href="/dist/css/application.min.css" rel="stylesheet">


<!-- Documentation extras -->
<link href="/assets/css/docs.css" rel="stylesheet">
<link href="/assets/css/pygments-manni.css" rel="stylesheet">
<!--[if lt IE 9]><script src="/assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="shortcut icon" href="/assets/ico/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" href="/assets/ico/apple-touch-icon.png" />
<link rel="apple-touch-icon" sizes="57x57" href="/assets/ico/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/assets/ico/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/assets/ico/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/assets/ico/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/assets/ico/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/assets/ico/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/assets/ico/apple-touch-icon-152x152.png" />

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48107165-1', 'cleverstack.io');
  ga('send', 'pageview');
  var tag = document.createElement('script');  tag.src = "http://www.youtube.com/player_api";  var firstScriptTag = document.getElementsByTagName('script')[0];  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  </script>

  </head>
  <body>
    <a class="sr-only" href="#content">Skip to main content</a>

    <div class="github-ribbon">
       <a href="https://github.com/cleverstack/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
    </div>

    <!-- Docs master nav -->
    <header class="navbar navbar-inverse navbar-fixed-top bs-docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">CleverStack.io</a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/getting-started">Getting started</a>
        </li>
        <li>
          <a href="/why-cleverstack">Why cleverstack?</a>
        </li>
        <li>
          <a href="/modules">Modules</a>
        </li>
        <li>
          <a href="/documentation">Documentation</a>
        </li>
<!--         <li>
          <a href="/css">CSS</a>
        </li>
        <li>
          <a href="/components">Components</a>
        </li>
        <li>
          <a href="/javascript">JavaScript</a>
        </li>
        <li>
          <a href="/customize">Customize</a>
        </li> -->
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/about">About</a>
        </li>
      </ul>
    </nav>
  </div>
</header>


    <!-- Docs page layout -->
    <div class="bs-header" id="content">
      <div class="container">
        <h1>Backend Documenation</h1>
        <p>Indepth guides for CleverStack's Backend covering installation, configuration, usage and extending.</p>
      </div>
    </div>

    <!-- Callout for the old docs link -->
    <!-- <div class="bs-old-docs">
  <div class="container">
    <strong>
      <a href="/2.3.2/">Looking for Bootstrap 2.3.2 docs?</a>
    </strong>
    We've moved it to a new home while we push forward with Bootstrap 3. <a href="http://blog.getbootstrap.com/">Read the blog</a> for details.
  </div>
</div>
 -->

    <div class="container bs-docs-container">

      <div class="row">
        <div class="col-md-3">
          <div class="bs-sidebar hidden-print" role="complementary">
            <ul class="nav bs-sidenav">
              
                <li><a href="/documentation" style="padding-left: 10px !important;color: #563d7c;"><strong>Documentation</strong> <br/><small>(viewing Backend)</small></a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#project-structure">Project Structure</a></li>
<li><a href="#grunt-tasks">Grunt Tasks</a></li>
<li><a href="#gulp-tasks">Gulp Tasks</a></li>
<li><a href="#magic-modules">Magic Modules</a></li>
<li><a href="#di">Dependency Injection</a></li>
<li><a href="#classes">Classes</a></li>
<li><a href="#modules">Modules</a>
<li><a href="#controllers">Controllers</a>
<li><a href="#services">Services</a>
<li><a href="#models">Models</a>
<li><a href="#testing">Testing</a>
  <ul class="nav">
    <li><a href="#testing-unit">Running Unit Tests</a></li>
    <li><a href="#testing-e2e">Running E2E Tests</a></li>
    <li><a href="#testing-coverage">Code Coverage Reports</a></li>
  </ul>
</li>
<li>
  <a href="#deployment">Build &amp; Deployment</a>
  <ul class="nav">
    <li><a href="#deployment-build">Production Builds</a></li>
    <li><a href="#deployment-strategies">Deployment Strategies</a></li>
  </ul>
</li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#contributing">Contributing</a></li>

              
            </ul>
          </div>
        </div>
        <div class="col-md-9" role="main">
            <!-- Back-end (NodeJS)
  ================================================== -->
  <div class="bs-docs-section">
    <div class="section-page"><h3 id="introduction" class="page-header">
  Introduction <a class="permalink" href="/documentation/backend/#backend-introduction" title="Permalink"><small>Â¶</small></a>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Introduction</li>
</ol>

<p class="lead sub">CleverStack's Backend (Node Seed) has been designed to provide you with a super fast test driven back-end development lifecycle. Everything you need should be just one command away, if it's not please open an issue or fork the repo on github and submit a pull request.</p>

<h5 class="page-header">Highlights</h5>
<ul>
  <li><a href="http://nodejs.org/api/cluster.html">Clustered,</a> enterprise application with high <a href="http://en.wikipedia.org/wiki/Concurrency_(computer_science)">Concurrency</a> out of the box.</li>
  <li>Asynchronous, <a href="http://nodejs.org/">NodeJS</a> Powered Non-Blocking Core.</li>
  <li>Modular Architecture with Open Source Eco System for modules.</li>
  <li>MEAN Stack and so much more! (Mongo, Express, Angular, Node)</li>
  <li>Official ODM (<a href="http://css.dzone.com/articles/era-object-document-mapping">Object Document Mapper</a>) Module provides an enterprise <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a> based solution out of the box.</li>
  <li>Official ORM (<a href="http://en.wikipedia.org/wiki/Object-relational_mapping">Object Relational Mapper</a>) Module provides an enterprise <a href="http://en.wikipedia.org/wiki/SQL">SQL</a>  based solution out of the box.</li>
  <li>Databases supported: <a href="http://www.mysql.com/">MySQL</a>, MSSQL, Oracle, MariaDB, <a href="http://www.postgresql.org/">PostgreSQL</a>, <a href="http://www.sqlite.org/">SQLite</a> or <a href="http://www.mongodb.org/">MongoDB</a>.</li>
  <li>CLI Commands available to help ease your workload (including generators)</li>
  <li><a href="http://gruntjs.com/">Grunt</a> powered tasks, including Server with Live Restart using <a href="https://www.npmjs.org/package/nodemon">nodemon.</a></li>
  <li>NodeJS <a href="https://github.com/CleverStack/clever-background-tasks">Background Tasks Module</a> which allows CPU intensive (blocking) operations to take place in separate processes, allowing your HTTP Web Server Processes to continue serving HTTP Requests.</li>
  <li>Unit &amp; E2E (Integration) Testing with <a href="https://www.npmjs.org/package/mocha">Mocha</a> and <a href="https://www.npmjs.org/package/request">Request</a>.</li>
  <li>Code Coverage reports for E2E and Unit test/s.</li>
  <li>Powerful database rebase and seed tools for Rapid Application Development</li>
</ul>
</div>
<div class="section-page"><h3 id="installation" class="page-header">
  Installation <a class="permalink" href="/documentation/backend/#backend-installation" title="Permalink"><small>Â¶</small></a><br/>
  <small>By using the CleverStack CLI's install command, installation is easy and straight forward.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Installation</li>
</ol>
<p class="lead">To create a new project using the CleverStack CLI.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># for frontend &amp; backend</span>
clever init my-app

<span class="c"># backend only</span>
clever init my-app backend</code></pre></div>

<img src="/assets/img/screenshots/clever-init-backend.png" width="100%">
<br/>
<br/>
<p><span class="label label-info">Note</span> After running this command you may be prompted to configure the module/s your installing, see <a href="#configuration">Configuration</a> for more information. Additionally you may be prompted to setup the seed data for the module/s your installing, see <a href="/documentation/backend/models/#seed-data">Seed Data</a> for more information.</p>
<br/>

<div class="bs-callout bs-callout-danger">
  <h4>Database creation</h4>
  <p>If you are using SQL/ORM (aka MySQL, Postgre etc) then you will need to manually run the <code>CREATE DATABASE</code> command to create your database, the underlying library we use does not support this functionality.
  </p>
</div>

<div class="bs-callout bs-callout-warning">
  <h4>Init running time</h4>
  <p>This command may take awhile depending on your internet connection and computer specifications.</p>
</div>

<div class="bs-callout bs-callout-warning">
  <h4>Command Failed Errors</h4>
  <p>If you see a command failed error in your terminal/console after installing a module and seeing a message that states it's about to rebase or seed your database, it is highly likely that something is wrong with your configuration that you need to fix.<br/>
  See <a href="#configuration">Configuration</a> and <a href="#seed-data">Seed Data</a> for information.</p>
</div>
</div>
<div class="section-page"><h3 class="page-header" id="configuration">
  Configuration <a class="permalink" href="#backend-configuration" title="Permalink"><small>Â¶</small></a><br/>
  <small>Sophisticated deep-merged configuration allows ultimate flexibility between environments</small>
</h3>
<ol class="breadcrumb">
  <li><a href="#overview">Documentation</a></li>
  <li><a href="#backend">Backend</a></li>
  <li class="active">Configuration</li>
</ol>
<p class="lead sub">To make configuration as easy and comprehensive as possible, you are not only able to define a global.json configuration file, you can also define configuration files for each environment regardless of what you call them.</p>

<blockquote>
  <h6>If youâre willing to restrict the flexibility of your approach, you can almost always do something better.</h6>
  <footer style="font-size: 12px;">John Carmack</footer>
</blockquote>
<br/>

<p>Consider the following code, which uses a "Magic Module" to load the json configuration files and deeep merge them</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">);</span></code></pre></div>

<h5 class="page-header">Loading Order</h5>
<p>Each of the following files are loaded and then deep merged into one application config object, in the exact order listed here.</p>
<ol>
  <li><a href="https://github.com/CleverStack/Node-Seed/tree/master/config/global.json">/config/global.json</a>
    <ul>
      <li>
        Define the global configuration for your application here.
        <div class="bs-callout bs-callout-danger">
          <h4>Required for configuration</h4>
          <p>This file is required and must exist, as this is the place for any default (or GLOBAL) configuration. Don't Delete!</p>
        </div>
      </li>
    </ul>
  </li>
  <li>/modules/&lt;module&gt;/config/default.json
    <ul>
      <li>
        Every modules /config/default.json file will be loaded
        <div class="bs-callout bs-callout-info">
          <h4>Module's default.json</h4>
          <p>See <a href="#backend-modules-config-default">&lt;module&gt;/config/default.json</a> for more information</p>
        </div>
      </li>
    </ul>
  </li>
  <li>/modules/&lt;module&gt;/config/global.json
    <ul>
      <li>
        Every modules /config/global.json file will be loaded
        <div class="bs-callout bs-callout-info">
          <h4>Module's global.json</h4>
          <p>See <a href="#backend-modules-config-global">&lt;module&gt;/config/global.json</a> for more information</p>
        </div>
      </li>
    </ul>
  </li>
  <li>/config/&lt;NODE_ENV&gt;.json <strong>(environment specific configuration)</strong>
    <ul>
      <li>This allows you to modify or extend the configuration for each environment, regardless of what name you give an environment.</li>
        <div class="bs-callout bs-callout-info">
          <h4>Default Environment Names</h4>
          <p>The default environment names are, LOCAL, DEV, STAG and PROD.</p>
        </div>
        <div class="bs-callout bs-callout-danger">
          <h4>Environment Specific Configuration</h4>
          <p>To take advantage of an environment based configuration file, you need to set an Environment Variable called <code>NODE_ENV</code> to the name you called your environment. (We use <code>NODE_ENV=LOCAL</code> for local development).</p>
        </div>
      </li>
    </ul>
  </li>
</ol>
</div>
<div class="section-page"><h3 id="project-structure" class="page-header">
  Structure <a class="permalink" href="#backend-structure" title="Permalink"><small>Â¶</small></a><br/>
  <small>Cleverstacks's Architecture has been designed to be simple and intiutive to use and extend.</small><br/>
</h3>
<ol class="breadcrumb">
  <li><a href="#overview">Documentation</a></li>
  <li><a href="#backend">Backend</a></li>
  <li class="active">Structure</li>
</ol>
<!-- <p class="lead sub">Cleverstack provides a clear and simple structure that will make writing even the most (seemingly) complex applications trivial.</p> -->

<blockquote>
  <h6>Complexity kills. It sucks the life out of developers, it makes products difficult to plan, build and test, it introduces security challenges and it causes end-user and administrator frustration.</h6>
  <footer style="font-size: 12px;">Ray Ozzie</footer>
</blockquote>

<h5 class="page-header">Folder Structure</h5>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">node-seed/
âââ config/           <span class="c"># configuration files</span>
âââ lib/              <span class="c"># cleverstack core</span>
âââ modules/          <span class="c"># backend modules</span>
âââ schema/           <span class="c"># backend schema</span>
â   âââ seedData.json <span class="c"># application seed data in JSON format</span>
âââ tasks/            <span class="c"># build/dev tasks</span>
â   âââ grunt/        <span class="c"># grunt tasks</span>
â   âââ gulp/         <span class="c"># gulp tasks</span>
âââ tests/            <span class="c"># global app and cleverstack core tests</span>
â   âââ e2e/          <span class="c"># end to end tests</span>
â   âââ unit/         <span class="c"># unit tests</span>
âââ Gruntfile.js      <span class="c"># app grunt config &amp; tasks</span>
âââ cluster.js        <span class="c"># runs a clustered server with multiple app.js workers</span>
âââ app.js            <span class="c"># runs a single node http server</span>
âââ package.json      <span class="c"># npm dependencies and package information</span></code></pre></div>

<h5 class="page-header">Important files and folders</h5>
<dl class="dl-horizontal">
  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/config">config/</a></dt>
  <dd>This is where you define all of your configuration files like your global.json and for each of your environments (default is local, dev, stag, prod), see <a href="#backend-configuration">Configuration</a> for more information.</dd><br>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/lib">lib/</a></dt>
  <dd>
    <p>This is where the Cleverstack Core is kept, we recommended not modifying anything in this this folder unless you know what you are doing.</p>

    <div class="bs-callout bs-callout-info">
      <h4>Magic Modules</h4>
      <p>Certain folders are magic modules and can be required in like <code>require( 'models' )</code>, this is made possible by the use of the NODE_PATH variable.</p>
    </div>

    <div class="bs-callout bs-callout-danger">
      <h4>Modification warning</h4>
      <p>
        If you modify files in this folder, then it is highly likely things may not work if you do not know what you are doing. It is also important to remember that making changes in here makes it hard to upgrade or downgrade your backend without loosing your changes.
      </p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/modules">modules/</a></dt>
  <dd>
    <p>This is where all of the Cleverstack modules will be installed into your application.</p>
    <p>You also add custom modules inside this folder, either by creating it manually or using the CleverStack CLI's install, generate or scaffold commands.</p>

    <div class="bs-callout bs-callout-info">
      <h4>NPM Modules/Packages</h4>
      <p>You can place any NPM module inside this directory, however to take advantage of the true power &amp; flexibility of CleverStack you will need to add and change some key (but easy) points.</p>
        <p><span class="label label-warning">Example</span> See the <a href="https://github.com/CleverStack/backend-example-module">Backend Example Module</a> for an example of how to create a cleverstack enhanced module.</p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/schema">schema/</a></dt>
  <dd>
    <p>This is where all your application/project wide/specific seed data should go, stored in the schema/seedData.json.</p>
    <p>Also the default location for any sql scripts/dumps/triggers etc...</p>

    <div class="bs-callout bs-callout-info">
      <h4>Schema SQL &amp; Seed Data</h4>
      <p>See <a href="/documentation/backend/models/#seed-data">Seed Data</a> for more information regarding seedData.</p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/tasks">tasks/</a></dt>
  <dd>
    <p>This provides you with two easy to use folders, one for grunt tasks and the other for gulp tasks.</p>
    <div class="bs-callout bs-callout-info">
      <h4>Development/Build Tasks</h4>
      <p>See <a href="/documentation/backend/#grunt-tasks">Grunt Tasks</a> and <a href="/documentation/backend/#gulp-tasks">Gulp Tasks</a> for more information.</p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/cluster.js">cluster.js</a></dt>
  <dd>
    <p>This is the main entry point of a normal CleverStack "Clustered" Application, in most cases you will not need to modify this file.</p>
    <div class="bs-callout bs-callout-info">
      <h4>Module <code>bin/cluster.js</code> Hook</h4>
      <p>By placing a file in any modules <code>/modules/:moduleName/bin/</code> folder called <code>cluster.js</code> you are able to "hook into" when your cluster starts, it will be loaded and run before the cluster.js file is executed, (Example: If the background-tasks module is installed and enabled, this type of hook will setup the background task process.)</p>
      <p><span class="label label-warning">Example</span> See the <a href="https://github.com/CleverStack/clever-background-tasks/blob/master/bin/cluster.js">Clever Background Tasks cluster.js hook</a> for an example of how you can use this feature.</p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/Gruntfile.js">Gruntfile.js</a></dt>
  <dd>
    <ul>
      <li>Defines the Applications global (main) gruntConfig.</li>
      <li>Registers the Applications included Grunt tasks.</li>
      <li>Provides an easy mechanism for modules to extend the gruntConfig and register/modify grunt tasks.</li>
    </ul>

    <div class="bs-callout bs-callout-warning">
      <h4>Module Gruntfile's</h4>
      <p>Each module's Gruntfile.js config is deep merged into this files main grunt config before registering any tasks with grunt, which gives you the power to both add grunt tasks and modify the gruntConfig inside each module.</p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/app.js">app.js</a></dt>
  <dd>
    <p>This files main use is the entry point of each HTTP Web Serving child process within the "Clustered" environment that app.js provides.</p>

    <div class="bs-callout bs-callout-danger">
      <h4>Debugging</h4>
      <p>You can use this script to spawn a single processed Application, useful for debugging with node-inspector so it will attach to the process by using --debug-brk.</p>
      <p><span class="label label-danger">Important</span> To run this file on its own you will need to manually set your NODE_PATH to <code>./lib/:./modules/</code> for linux and <code>./lib/;./modules/</code> for windows.</p>
    </div>
  </dd>

  <dt><a href="https://github.com/CleverStack/Node-Seed/tree/master/package.json">package.json</a></dt>
  <dd>
    <p>This file defines the Application and it's information, scripts and NPM dependencies just like every other NPM Module.</p>
  </dd>
</dl>
</div>
<div class="section-page"><h3 id="grunt-tasks" class="page-header">
  Grunt Tasks <a class="permalink" href="/documentation/backend/#grunt-tasks" title="Permalink"><small>Â¶</small></a><br/>
  <small>Modular configuration and registration of grunt task's with ease.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Grunt Tasks</li>
</ol>
<p class="lead">Simply by placing a javascript file in the <code>backend/tasks/grunt</code> folder.</p>

<p>Task files should export an Object Literal containing the <code>config</code> and <code>register</code> keys, unless the task does not need to register, in that case you can just export the config on the root level of the object.</p>

<div class="bs-callout bs-callout-warning">
  <h4>Important information about naming grunt task files</h4>
  <p>The name of the file will be used as the key inside the gruntConfig, as an example, for the grunt task concurrent.js, the gruntConfig would be gruntConfig[concurrent] </p>
</div>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="lineno"> 1</span> <span class="c1">// Config with register</span>
<span class="lineno"> 2</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
<span class="lineno"> 3</span>   <span class="nx">config</span><span class="o">:</span> <span class="p">{</span>
<span class="lineno"> 4</span>     <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
<span class="lineno"> 5</span>       <span class="c1">// ...</span>
<span class="lineno"> 6</span>     <span class="p">}</span>
<span class="lineno"> 7</span>   <span class="p">},</span>
<span class="lineno"> 8</span>   <span class="nx">register</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 9</span>     <span class="c1">// grunt.registerTask(&#39;build&#39;, [&#39;build:dist&#39;]);</span>
<span class="lineno">10</span>   <span class="p">}</span>
<span class="lineno">11</span> <span class="p">};</span>
<span class="lineno">12</span> 
<span class="lineno">13</span> <span class="c1">// Config on the root level</span>
<span class="lineno">14</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
<span class="lineno">15</span>   <span class="nx">dist</span><span class="o">:</span> <span class="p">{</span>
<span class="lineno">16</span>     <span class="c1">// ...</span>
<span class="lineno">17</span>   <span class="p">}</span>
<span class="lineno">18</span> <span class="p">}</span></code></pre></div>


<h5 id="grunt-tasks-included" class="page-header" style="color: #2980b9; font-size: 125%; font-weight: 500;">
  Available Grunt Tasks<br/>
  <small>In the node-seed 1.2.x</small>
</h5>
<ul>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/exec.js">exec</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/watch.js">watch</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/nodemon.js">nodemon</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/mochaTest.js">mochaTest</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/concurrent.js">concurrent</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/jshint.js">jshint</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/jsonlint.js">jsonlint</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/jsdoc2md.js">jsdoc2md</a></li>
  <li><a href="https://github.com/CleverStack/node-seed/blob/master/tasks/grunt/node-inspector.js">node-inspector</a></li>
</ul>
</div>
<div class="section-page"><h3 id="gulp-tasks" class="page-header">
  Gulp Tasks <a class="permalink" href="/documentation/backend/#gulp-tasks" title="Permalink"><small>Â¶</small></a><br/>
  <small>Flexible Gulp tasks for your build pipeline, that work alongside Grunt.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Gulp Tasks</li>
</ol>


<div class="bs-callout bs-callout-danger">
  <h4>Needs more information</h4>
  <p>This section of the documentation is either out-dated or incomplete, please ask for help in github or hipchat if you need more information.</p>
</div>
</div>
<div class="section-page"><h3 class="page-header" id="magic-modules">
  Magic Modules <a class="permalink" href="#backend-magic-modules" title="Permalink"><small>Â¶</small></a><br/>
  <small>The Magic that enables CleverStack to do things like require('injector'), require('config') etc</small>
</h3>
<ol class="breadcrumb">
  <li><a href="#overview">Documentation</a></li>
  <li><a href="#backend">Backend</a></li>
  <li class="active">Magic Modules</li>
</ol>
<p class="lead sub">Our NodeJS Backend takes advantage of an NPM feature called the <i>Node Path</i>, by using the environment variable <code>NODE_PATH</code> we are able to take advantage of require's hidden power.</p>

<p></p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">export </span><span class="nv">NODE_PATH</span><span class="o">=</span>./lib/:./modules/</code></pre></div>

<p><span class="label label-danger">Important</span> You will not need to set your <code>NODE_PATH</code> if you are using  only need to set your NODE_PATH when you are running <code>node/nodemon app.js</code>, not the main servers or commands (like <code>clever serve</code>.</p><br/>

<p>Using the Node Path and our magic module utility it gives you the ability to load things, like this</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;controllers&#39;</span><span class="p">).</span><span class="nx">ExampleController</span></code></pre></div>

<h5>Here is the complete list of Magic Modules, you can require() any of these anywhere in your application.</h5>
<ul>
  <li>injector</li>
  <li>classes</li>
  <li>config</li>
  <li>controllers</li>
  <li>exceptions</li>
  <li>models</li>
  <li>seedData</li>
  <li>services</li>
  <li>tasks</li>
  <li>utils</li>
</ul>
</div>
<div class="section-page"><h3 class="page-header" id="di">
	Dependency Injection <a class="permalink" href="#backend-di" title="Permalink"><small>Â¶</small></a><br/>
	<small>Asynchronous and fully Non-blocking dependency injection for Node (based on AngularJS)</small>
</h3>
<ol class="breadcrumb">
  <li><a href="#overview">Documentation</a></li>
  <li><a href="#backend">Backend</a></li>
  <li class="active">Dependency Injection</li>
</ol>

<blockquote>
	<h6>The unavoidable price of reliability is simplicity.</h6>
	<footer style="font-size: 12px;">C.A.R. Hoare</footer>
</blockquote>

<h5 class="page-header">Features</h5>
<ul>
  <li>Non-blocking and fully async</li>
  <li>Load's resources based upon name for you and injects dependencies</li>
  <li>Will never load the same resource more than once, it uses the one singular instance for all dependencies</li>
</ul>
<br>

<p>CleverStack Controllers, Services, Routes, Models and Tests are loaded and all of their dependencies are loaded and injected automatically using the <a href="https://github.com/cleverstack/clever-injector">CleverStack Dependency Injection</a> module.</p>

<p>When resources/files are loaded using the injector it will automatically load and inject any of it's dependencies in a recursive manner.</p>

<h5 class="page-header">Example Usage</h5>

<p>Simply put the name of the dependency you need in the function exported by the file and it will be loaded and injected for you automatically.</p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">SomeDependency</span> <span class="p">)</span> <span class="p">{</span>
  <span class="c1">// SomeDependency is loaded and injected into this function for you</span>
<span class="p">}</span></code></pre></div>
</div>
<div class="section-page"><h3 id="classes" class="page-header">
  Classes <a class="permalink" href="/documentation/backend/classes" title="Permalink"><small>Â¶</small></a><br/>
  <small>Lightning-fast and flexible OOP Style Classes</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Class</li>
</ol>
<p class="lead sub">In an effort to make read, writing and maintaining the documentation as easy as possible, we have put the documentation for Classes on it's own page.</p>
<p><a href="/documentation/backend/classes">View Documentation for <strong><i>Classes</i></strong></a></p>
</div>
<div class="section-page"><h3 id="modules" class="page-header">
  Modules <a class="permalink" href="/documentation/backend/modules" title="Permalink"><small>Â¶</small></a><br/>
  <small>Cleverstacks's Architecture has been designed to be simple and intiutive to use and extend.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Modules</li>
</ol>
<p class="lead sub">In an effort to make read, writing and maintaining the documentation as easy as possible, we have put the documentation for Modules on it's own page.</p>
<p><a href="/documentation/backend/modules">View Documentation for <strong><i>Modules</i></strong></a></p>
</div>
<div class="section-page"><h3 id="controllers" class="page-header">
  Controllers <a class="permalink" href="/documentation/backend/controllers" title="Permalink"><small>Â¶</small></a><br/>
  <small>Lightning-fast and flexible controller prototype.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Controllers</li>
</ol>
<p class="lead sub">In an effort to make read, writing and maintaining the documentation as easy as possible, we have put the documentation for Controllers on it's own page.</p>
<p><a href="/documentation/backend/controllers">View Documentation for <strong><i>Controllers</i></strong></a></p>
</div>
<div class="section-page"><h3 id="services" class="page-header">
  Services <a class="permalink" href="/documentation/backend/services" title="Permalink"><small>Â¶</small></a><br/>
  <small>Robust &amp; Flexible service layer that ensures you can easily change the underlying datasource without changing any controller/model code.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Services</li>
</ol>
<p class="lead sub">In an effort to make read, writing and maintaining the documentation as easy as possible, we have put the documentation for Services on it's own page.</p>
<p><a href="/documentation/backend/services">View Documentation for <strong><i>Services</i></strong></a></p>
</div>
<div class="section-page"><h3 id="models" class="page-header">
  Models <a class="permalink" href="/documentation/backend/models" title="Permalink"><small>Â¶</small></a><br/>
  <small>Robust &amp; Flexible Database Agnostic ORM &amp; ODM with powerful associations.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Models</li>
</ol>
<p class="lead sub">In an effort to make read, writing and maintaining the documentation as easy as possible, we have put the documentation for Models on it's own page.</p>
<p><a href="/documentation/backend/models">View Documentation for <strong><i>Models</i></strong></a></p>
</div>
<div class="section-page"><h3 id="testing" class="page-header">
  Testing <a class="permalink" href="/documentation/backend/#testing" title="Permalink"><small>Â¶</small></a><br/>
  <small>Modules contain their testing resources, there are two test types you can use, unit or e2e.</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Testing</li>
</ol>

<p class="lead">We believe in testing our code as we develop, then if something breaks we know exactly where to start looking. Spending more time on developing the features we love.</p>

<div class="section-page">
  <h3 id="testing-unit">Running Unit Tests</h3>
  <p>To run the unit tests for your app and modules, from the front-end/back-end root directory run:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash">clever <span class="nb">test </span>unit</code></pre></div>
  <p>Or simply use the alias:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash">clever <span class="nb">test</span></code></pre></div>
</div>

<div class="section-page">
  <h3 id="testing-e2e">Running E2E Tests</h3>
  <p>To setup your environment for e2e testing with Protractor run the following command. This will install Selenium Server (WebDriver), ChromeDriver & PhantomJS based on your OS. If you wish to run selenium server in a separate terminal then use Webdriver Manager (see below).</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd </span>Frontend
npm run-script setup-protractor</code></pre></div>
</div>


<div class="section-page">
  <h3>Using Webdriver Manager</h3>
  <div class="bs-callout bs-callout-danger">
    <h4>Needs more information</h4>
    <p>This section of the documentation is either out-dated or incomplete, please ask for help in github or hipchat if you need more information.</p>
  </div>

  <p>Webdriver Manager comes shipped with protractor and installs selenium server & chrome driver for you. Selenium server can then run in a separate terminal so when you run your e2e tests it doesn't need to boot up (saving heaps of time when running your e2e tests!). To set this up do the following:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash">npm install -g protractor
  webdriver-manager update
  webdriver-manager start</code></pre></div>

  <p>Your selenium server should be running in this terminal.</p>
  <p>Finally update your e2e test config file located: my-app/Frontend/test-e2e.conf.js</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash">// uncomment this line:
  seleniumAddress: <span class="s1">&#39;http://localhost:4444/wd/hub&#39;</span>,

  // comment these lines:
  seleniumServerJar: <span class="s1">&#39;&#39;</span>
  seleniumPort: <span class="s1">&#39;&#39;</span>
  chromeDriver: <span class="s1">&#39;&#39;</span></code></pre></div>

  <p>To run the end-to-end tests for your app and modules, from the front-end/back-end root directory run:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>clever <span class="nb">test </span>e2e</code></pre></div>
</div>

<div class="section-page">
  <h3 id="testing-coverage">Code Coverage Reports</h3>
  <p>To generate a code coverage report for your unit tests, from the front-end directory run:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>clever <span class="nb">test </span>coverage</code></pre></div>
  <p>Your browser should open the following URL:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>http://localhost:5555</code></pre></div>
  <p>Then select your report from the list.</p>
</div>
</div>
<div class="section-page"><h3 id="deployment" class="page-header">
  Deployment <a class="permalink" href="/documentation/backend/#deployment" title="Permalink"><small>Â¶</small></a><br/>
  <small>Using the Amazon AWS Cloud</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Deployment</li>
</ol>
<p class="lead">We build lots of MVP's so we like our deployment to be as efficient as possible. We are going to implement some of these strategies for CleverStack.</p>

<div class="section-page">
  <h4 id="deployment-build">Production Builds</h4>
  <p>To build a production version of your front-end app, from your front-end root directory run:</p>
  <div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>clever build</code></pre></div>
  <p>This will build your app, minifying your assets etc and puts everything into the /dist folder ready for deployment.</p>
  <p>Note: You can view a production version of your app on port 9009.</p>
</div>

<div class="section-page">
  <h4 id="deployment-strategies">Deployment Strategies</h4>
  <p>Stay Tuned!! NodeJS deployment strategies coming soon. AWS, Heroku and more.</p>

  <div class="bs-callout bs-callout-danger">
    <h5>Needs more information</h5>
    <p>This section of the documentation is either out-dated or incomplete, please ask for help in github or hipchat if you need more information.</p>
  </div>
</div>
</div>
<div class="section-page"><h3 id="troubleshooting" class="page-header">
  Troubleshooting <a class="permalink" href="/documentation/backend/#troubleshooting" title="Permalink"><small>Â¶</small></a><br/>
  <small>What to do when your stuck on some issue</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Troubleshooting</li>
</ol>
<p class="lead">There are currently a few resources available to reach out to us</p>

<h6><a href="https://github.com/CleverStack/node-seed/issues">Search GitHub issues, if you found a bug but don't see a ticket for it, please <a href="https://github.com/CleverStack/node-seed/issues">open an issue</a>. </a></h6>
<h6><a href="https://groups.google.com/forum/#!forum/clever-stack">Get some help from the Google Group</a></h6>
<h6><a href="http://stackoverflow.com/questions/tagged/cleverstack">Get some help from Stack Overflow</a></h6>
<h6><a href="http://webchat.freenode.net/?randomnick=1&channels=%23cleverstack&uio=d4">Get some help from IRC</a></h6><br>

<p class="sub lead">We will document any "gotchas" here along with any important open GitHub issues. Please <a href="https://github.com/CleverStack/node-seed/issues">open an issue</a> if you see a bug.</p></p>
<ul>
  <li>Frontend: EMFILE error on Mac: By default some macs have a ulimit of 256 which limits the number of open files each process can have, when using "clever init my-app" you will need to raise your ulimit by running "ulimit -n 1024" in your console. You will need to run that in your console before running the init command unless you define that setting globally in your mac.</li>
</ul>
</div>
<div class="section-page"><h3 id="contributing" class="page-header">
  Contributing <a class="permalink" href="/documentation/backend/#contributing" title="Permalink"><small>Â¶</small></a><br/>
  <small>We would love your help with CleverStack, even if it's just testing/reporting bugs</small>
</h3>
<ol class="breadcrumb">
  <li><a href="/documentation">Documentation</a></li>
  <li><a href="/documentation/backend">Backend</a></li>
  <li class="active">Contributing</li>
</ol>

<p>Firstly please read our <a href="https://github.com/CleverStack/Node-Seed/blob/master/CONTRIBUTING.md">guidelines for contributing</a>, Then fork the <a href="https://github.com/CleverStack/Node-Seed">CleverStack Node Seed</a> github repo, once you are ready please submit a "Pull Request" for review.</p>
</div>

  </div>

        </div>
      </div>

    </div>

    <footer class="container text-center padtop" role="contentinfo">
      <p class="legal">Cleverstack.io is developed and maintained by <a href="http://au.linkedin.com/in/richardgustin" target="_blank">Richard Gustin</a> (<a href="https://github.com/pilsy" target="_blank">@pilsy</a>),<br/>our core developers, our open source community and <a href="http://www.clevertech.biz/" target="_blank">Clevertech</a>.<br/>2015 Cleverstack.io All Rights Reserved.</p>
    </footer>

    <!-- JS and analytics only. -->
    <!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="/dist/js/bootstrap.min.js"></script>

<!-- <script src="/assets/js/holder.js"></script> -->
<!-- <script src="/dist/js/application.min.js"></script> -->
<script src="/assets/js/application.js"></script>






<script>
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id; js.async=1;
    js.src="https://platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>

<!-- Analytics
================================================== -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48107165-1', 'cleverstack.io');
  ga('send', 'pageview');

  // var _gauges = _gauges || [];
  // (function() {
  //   var t   = document.createElement('script');
  //   t.async = true;
  //   t.id    = 'gauges-tracker';
  //   t.setAttribute('data-site-id', '4f0dc9fef5a1f55508000013');
  //   t.src = '//secure.gaug.es/track.js';
  //   var s = document.getElementsByTagName('script')[0];
  //   s.parentNode.insertBefore(t, s);
  // })();
</script>


  </body>
</html>
